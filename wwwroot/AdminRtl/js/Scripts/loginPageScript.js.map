{"version":3,"file":"loginPageScript.js","sourceRoot":"","sources":["loginPageScript.ts"],"names":[],"mappings":";AAAA,kCAAkC;AAElC,IAAI,UAAU,GAAG;IACb,SAAS,EAAC,wBAAwB;IAClC,SAAS,EAAE,CAAC,CAAC,aAAa,CAAC;IAC3B,cAAc,EAAE,CAAC,CAAC,eAAe,CAAC;IAClC,cAAc,EAAG,CAAC,CAAC,iBAAiB,CAAC;IACrC,YAAY,EAAG,CAAC,CAAC,eAAe,CAAC;IACjC,YAAY,EAAE,CAAC,CAAC,eAAe,CAAC;IAChC,kBAAkB,EAAE,CAAC,CAAC,qBAAqB,CAAC;IAC5C,iCAAiC,EAAjC;QACI,QAAQ,CAAC,gBAAgB,CAAC,kBAAkB,EAAE;YAC1C,IAAI,QAAQ,GAAG,QAAQ,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC;YACtD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACrC,QAAQ,CAAC,CAAC,CAAS,CAAC,SAAS,GAAG,UAAU,CAAK;oBAC5C,CAAC,CAAC,MAAM,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;oBAC/B,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,EAAE;wBAC1B,CAAC,CAAC,MAAM,CAAC,iBAAiB,CAAE,CAAC,CAAC,MAA2B,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC;qBACpF;gBACL,CAAC,CAAC;gBACD,QAAQ,CAAC,CAAC,CAAS,CAAC,OAAO,GAAG,UAAU,CAAM;oBAC3C,CAAC,CAAC,MAAM,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;gBACnC,CAAC,CAAC;aACL;QACL,CAAC,CAAC,CAAA;IACN,CAAC;IACD,QAAQ;QACJ,CAAC,CAAC,YAAY,CAAC,WAAW,GAAG,kBAAkB,CAAC;QAChD,CAAC,CAAC,qCAAqC,CAAC,CAAC,KAAK,CAAC;YAC3C,CAAC,CAAC,YAAY,CAAC,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;YACvC,OAAO,KAAK,CAAC;QACjB,CAAC,CAAC,CAAC;QACH,CAAC,CAAC,iBAAiB,CAAC,CAAC,KAAK,CAAC,UAAU,CAAC;YAClC,IAAI,KAAK,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC;YACpB,IAAI,KAAK,CAAC,GAAG,EAAE,IAAI,OAAO;gBACtB,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;;gBAElB,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,CAAA;QAC1B,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,iCAAiC,EAAE,CAAC;IAC7C,CAAC;IACD,kBAAkB,EAAlB,UAAmB,MAAgB;QAC/B,IAAI,MAAM,CAAC,MAAM,IAAI,CAAC;YAAE,OAAO,CAAC,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC;aAC5D,IAAI,MAAM,CAAC,MAAM,IAAI,CAAC,EAAE;YACzB,IAAI,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;YACxC,EAAE,CAAC,WAAW,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;YAC3B,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;SAChB;aACI;YACD,IAAI,SAAS,GAAG,QAAQ,CAAC,sBAAsB,EAAE,CAAC;YAClD,KAAkB,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAM,EAAE;gBAArB,IAAI,KAAK,eAAA;gBACV,IAAI,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;gBACxC,EAAE,CAAC,WAAW,GAAG,KAAK,CAAC;gBACvB,SAAS,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;aAC7B;YACD,OAAO,CAAC,CAAC,SAAS,CAAC,CAAA;SACtB;IACL,CAAC;IACD,UAAU,EAAV,UAAW,KAAU,EAAE,UAAkB;QAE7B,IAAA,aAAE,EAAE,iBAAI,EAAE,yBAAQ,EAAE,+BAAW,EAAE,yBAAQ,CAAW;QAC5D,CAAC,CAAC,cAAc,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;QAC1B,CAAC,CAAC,gBAAgB,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAC9B,CAAC,CAAC,oBAAoB,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACtC,CAAC,CAAC,uBAAuB,CAAC,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;QAC5C,CAAC,CAAC,oBAAoB,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACtC,CAAC,CAAC,sBAAsB,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;QAC1C,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE,CAAC;IACrC,CAAC;IACD,eAAe,EAAf;QAAA,mBAyCC;QAxCG,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,UAAA,CAAC;YACrB,OAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,UAAA,CAAC;YACrB,OAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACjC,CAAC,CAAC,CAAA;QACF,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAC,CAAK;YACxB,CAAC,CAAC,cAAc,EAAE,CAAC;YAEnB,IAAI,QAAQ,GAAG,OAAI,CAAC,YAAY,CAAE,GAAG,EAAE,IAAE,EAAE,CAAC;YAC5C,IAAI,QAAQ,GAAG,OAAI,CAAC,YAAY,CAAC,GAAG,EAAE,IAAE,EAAE,CAAC;YAC3C,IAAI,UAAU,GAAG,CAAC,CAAC,iBAAiB,CAAC,CAAC,GAAG,EAAE,CAAC;YAC5C,IAAI,SAAS,GAAG,eAAe,CAAC;YAChC,IAAI,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC;gBACtB,SAAS,WAAA;gBACT,QAAQ,UAAA;gBACR,QAAQ,UAAA;aACX,CAAC,CAAC;YACH,OAAI,CAAC,cAAc,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;YAC7C,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,IAAI,CAAC;iBACxB,IAAI,CAAC,UAAA,IAAI;gBACE,IAAA,gBAAI,EAAiB,8BAAK,CAAY;gBAC9C,OAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;gBAC3B,OAAI,CAAC,UAAU,CAAC,IAAI,EAAE,UAAoB,CAAC,CAAC;YAChD,CAAC,CAAC;iBACD,KAAK,CAAC,UAAC,CAAM;;gBACV,IAAI,QAAQ,SAAG,CAAC,CAAC,YAAY,0CAAE,MAAM,CAAC;gBACtC,IAAI,QAAQ,EAAE;oBACF,IAAA,cAAC,EAAE,4BAAQ,EAAE,4BAAQ,CAAc;oBAC3C,OAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;oBAC5B,OAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,MAAM,CAAC,OAAI,CAAC,kBAAkB,CAAC,QAAe,CAAC,CAAC,CAAC;oBAC1E,OAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,MAAM,CAAC,OAAI,CAAC,kBAAkB,CAAC,QAAe,CAAC,CAAC,CAAA;iBAC5E;YACL,CAAC,CAAC;iBACD,MAAM,CAAC;gBACJ,OAAI,CAAC,cAAc,CAAC,aAAa,EAAE,CAAC;YACxC,CAAC,CAAC,CAAC;QAEX,CAAC,CAAC,CAAA;IACN,CAAC;IACD,cAAc,EAAd,UAAe,KAAa;QACxB,YAAY,CAAC,OAAO,CAAC,OAAO,EAAC,KAAK,CAAC,CAAA;IACvC,CAAC;IACD,KAAK;QACD,IAAI,CAAC,QAAQ,EAAE,CAAC;QAChB,IAAI,CAAC,eAAe,EAAE,CAAC;IAC3B,CAAC;CACJ,CAAA;AACD,UAAU,CAAC,KAAK,EAAE,CAAC","sourcesContent":["/// <reference path=\"utiles.js\" />\r\n \r\nlet operations = {\r\n    _loginUrl:\"/api/admin/auth/signin\",\r\n    loginForm: $('#login-form'),\r\n    generalErrorEL: $('#generalError'),\r\n    loginBtnSubmit : $('#loginBtnSubmit'),\r\n    userNameInpt : $('#userNameInpt'),\r\n    passwordInpt: $('#passwordInpt'),\r\n    PostedFormOfSignIn: $('#PostedFormOfSignIn'),\r\n    setCustomHtml5InputsRequiredTitle() {\r\n        document.addEventListener(\"DOMContentLoaded\", function () {\r\n            var elements = document.getElementsByTagName(\"INPUT\");\r\n            for (var i = 0; i < elements.length; i++) {\r\n                (elements[i] as any).oninvalid = function (e:any) {\r\n                    e.target.setCustomValidity(\"\");\r\n                    if (!e.target.validity.valid) {\r\n                        e.target.setCustomValidity((e.target as HTMLInputElement).getAttribute('title'));\r\n                    }\r\n                };\r\n                (elements[i] as any).oninput = function (e: any) {\r\n                    e.target.setCustomValidity(\"\");\r\n                };\r\n            }\r\n        })\r\n    },\r\n    initWork() {\r\n        $.ajaxSettings.contentType = \"application/json\";\r\n        $('.login-content [data-toggle=\"flip\"]').click(function () {\r\n            $('.login-box').toggleClass('flipped');\r\n            return false;\r\n        });\r\n        $('#rememberMeInpt').click(function (e) {\r\n            var _this = $(this);\r\n            if (_this.val() == \"false\")\r\n                _this.val(\"true\");\r\n            else\r\n                _this.val(\"false\")\r\n        });\r\n        this.setCustomHtml5InputsRequiredTitle();\r\n    },\r\n    getErrorsContainer(errors: string[]) {\r\n        if (errors.length == 0) return $(document.createElement('span'));\r\n        else if (errors.length == 1) {\r\n            var el = document.createElement('span');\r\n            el.textContent = errors[0];\r\n            return $(el);\r\n        }\r\n        else {\r\n            var container = document.createDocumentFragment();\r\n            for (let error of errors) {\r\n                var el = document.createElement('span');\r\n                el.textContent = error;\r\n                container.appendChild(el);\r\n            }\r\n            return $(container)\r\n        }\r\n    },\r\n    SignInPost(model: any, rememberMe: string) {\r\n        \r\n        const { id, name, userName, phoneNumber, prevligs } = model;\r\n        $('#PostSign_Id').val(id);\r\n        $('#PostSign_Name').val(name);\r\n        $('#PostSign_UserName').val(userName);\r\n        $('#PostSign_PhoneNumber').val(phoneNumber);\r\n        $('#PostSign_Prevligs').val(prevligs);\r\n        $('#PostSign_RememberMe').val(rememberMe);\r\n        this.PostedFormOfSignIn.submit();\r\n    },\r\n    handleLoginForm() {\r\n        const _this = this;\r\n        this.userNameInpt.focus(e => {\r\n            this.generalErrorEL.text('');\r\n        });\r\n        this.passwordInpt.focus(e => {\r\n            this.generalErrorEL.text('');\r\n        })\r\n        this.loginForm.submit((e:any) => {\r\n            e.preventDefault();\r\n            \r\n            let userName = this.userNameInpt .val()||\"\";\r\n            let password = this.passwordInpt.val()||\"\";\r\n            let rememberMe = $('#rememberMeInpt').val();\r\n            let adminType = \"Administrator\";\r\n            var data = JSON.stringify({\r\n                adminType,\r\n                userName,\r\n                password\r\n            });\r\n            this.loginBtnSubmit.setLoading('fa-sign-in');\r\n            $.post(_this._loginUrl, data)\r\n                .then(data => {\r\n                    const { user, accessToken: { token } } = data;\r\n                    this.storeUserToken(token);\r\n                    this.SignInPost(user, rememberMe as string);\r\n                })\r\n                .catch((e: any) => {\r\n                    var errorObj = e.responseJSON?.errors;\r\n                    if (errorObj) {\r\n                        const { G, UserName, Password } = errorObj;\r\n                        this.generalErrorEL.text(G);\r\n                        this.userNameInpt.next().append(this.getErrorsContainer(UserName as any));\r\n                        this.passwordInpt.next().append(this.getErrorsContainer(Password as any))\r\n                    }\r\n                })\r\n                .always(() => {\r\n                    this.loginBtnSubmit.removeLoading();\r\n                });\r\n            \r\n        })\r\n    },\r\n    storeUserToken(token: string) {\r\n        localStorage.setItem('token',token)\r\n    },\r\n    start() {\r\n        this.initWork();\r\n        this.handleLoginForm();\r\n    }\r\n}\r\noperations.start();"]}