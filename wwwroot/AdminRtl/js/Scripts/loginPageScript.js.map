{"version":3,"file":"loginPageScript.js","sourceRoot":"","sources":["loginPageScript.ts"],"names":[],"mappings":"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","sourcesContent":["\r\n(function () {\r\n    let operations = {\r\n        _loginUrl: \"/api/admin/auth/signin\",\r\n        loginForm: $('#login-form'),\r\n        generalErrorEL: $('#generalError'),\r\n        loginBtnSubmit: $('#loginBtnSubmit'),\r\n        userNameInpt: $('#userNameInpt'),\r\n        passwordInpt: $('#passwordInpt'),\r\n        PostedFormOfSignIn: $('#PostedFormOfSignIn'),\r\n        setCustomHtml5InputsRequiredTitle() {\r\n            document.addEventListener(\"DOMContentLoaded\", function () {\r\n                var elements = document.getElementsByTagName(\"INPUT\");\r\n                for (var i = 0; i < elements.length; i++) {\r\n                    (elements[i] as any).oninvalid = function (e: any) {\r\n                        e.target.setCustomValidity(\"\");\r\n                        if (!e.target.validity.valid) {\r\n                            e.target.setCustomValidity((e.target as HTMLInputElement).getAttribute('title'));\r\n                        }\r\n                    };\r\n                    (elements[i] as any).oninput = function (e: any) {\r\n                        e.target.setCustomValidity(\"\");\r\n                    };\r\n                }\r\n            })\r\n        },\r\n        initWork() {\r\n            $.ajaxSettings.contentType = \"application/json\";\r\n            $('.login-content [data-toggle=\"flip\"]').click(function () {\r\n                $('.login-box').toggleClass('flipped');\r\n                return false;\r\n            });\r\n            $('#rememberMeInpt').click(function (e) {\r\n                var _this = $(this);\r\n                if (_this.val() == \"false\")\r\n                    _this.val(\"true\");\r\n                else\r\n                    _this.val(\"false\")\r\n            });\r\n            this.setCustomHtml5InputsRequiredTitle();\r\n        },\r\n        getErrorsContainer(errors: string[]) {\r\n            if (errors.length == 0) return $(document.createElement('span'));\r\n            else if (errors.length == 1) {\r\n                var el = document.createElement('span');\r\n                el.textContent = errors[0];\r\n                return $(el);\r\n            }\r\n            else {\r\n                var container = document.createDocumentFragment();\r\n                for (let error of errors) {\r\n                    var el = document.createElement('span');\r\n                    el.textContent = error;\r\n                    container.appendChild(el);\r\n                }\r\n                return $(container)\r\n            }\r\n        },\r\n        SignInPost(model: any, rememberMe: string) {\r\n\r\n            const { id, name, userName, phoneNumber, prevligs } = model;\r\n            $('#PostSign_Id').val(id);\r\n            $('#PostSign_Name').val(name);\r\n            $('#PostSign_UserName').val(userName);\r\n            $('#PostSign_PhoneNumber').val(phoneNumber);\r\n            $('#PostSign_Prevligs').val(prevligs);\r\n            $('#PostSign_RememberMe').val(rememberMe);\r\n            this.PostedFormOfSignIn.submit();\r\n        },\r\n        handleLoginForm() {\r\n            const _this = this;\r\n            this.userNameInpt.focus(e => {\r\n                this.generalErrorEL.text('');\r\n            });\r\n            this.passwordInpt.focus(e => {\r\n                this.generalErrorEL.text('');\r\n            })\r\n            this.loginForm.submit((e: any) => {\r\n                e.preventDefault();\r\n\r\n                let userName = this.userNameInpt.val() || \"\";\r\n                let password = this.passwordInpt.val() || \"\";\r\n                let rememberMe = $('#rememberMeInpt').val();\r\n                let adminType = \"Administrator\";\r\n                var data = JSON.stringify({\r\n                    adminType,\r\n                    userName,\r\n                    password\r\n                });\r\n                this.loginBtnSubmit.setLoading('fa-sign-in');\r\n                $.post(_this._loginUrl, data)\r\n                    .then(data => {\r\n                        const { user, accessToken: { token } } = data;\r\n                        this.storeUserToken(token);\r\n                        this.SignInPost(user, rememberMe as string);\r\n                    })\r\n                    .catch((e: any) => {\r\n                        var errorObj = e.responseJSON?.errors;\r\n                        if (errorObj) {\r\n                            const { G, UserName, Password } = errorObj;\r\n                            this.generalErrorEL.text(G);\r\n                            this.userNameInpt.next().append(this.getErrorsContainer(UserName as any));\r\n                            this.passwordInpt.next().append(this.getErrorsContainer(Password as any))\r\n                        }\r\n                    })\r\n                    .always(() => {\r\n                        this.loginBtnSubmit.removeLoading();\r\n                    });\r\n\r\n            })\r\n        },\r\n        storeUserToken(token: string) {\r\n            localStorage.setItem('token', token)\r\n        },\r\n        start() {\r\n            this.initWork();\r\n            this.handleLoginForm();\r\n        }\r\n    }\r\n    operations.start();\r\n}());"]}