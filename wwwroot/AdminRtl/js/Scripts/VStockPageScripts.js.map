{"version":3,"file":"VStockPageScripts.js","sourceRoot":"","sources":["VStockPageScripts.ts"],"names":[],"mappings":"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","sourcesContent":["(function () {\r\n    const $tableLoadingEl = $('.vstockPageSection .ContainerOverlay').eq(0);\r\n    const $tableDomEl = $('#vstockTable');\r\n\r\n\r\n    const vstockConfig = {\r\n        _modal: $('#modal'),\r\n        _innerTable: $('#innerTable'),\r\n        _tableCounter: 0,\r\n        _modalTitle: $('#modal .modal-title'),\r\n        _modalBody: $('#modal .modal-body'),\r\n        _dataTable: null as any as DataTables.DataTable,\r\n        getNewInnerTable(data: IVStockDrug) {\r\n            this._tableCounter += 1;\r\n            var newTb = this._innerTable.clone();\r\n            newTb.removeClass('d-none');\r\n            newTb.attr('id', `vstockTable_${this._tableCounter}`);\r\n            newTb.DataTable({\r\n                data: data.products,\r\n                columnDefs: [\r\n                    {\r\n                        targets: 0,\r\n                        data: \"pharmacyName\",\r\n                        className: 'text-nowrap'\r\n                    },\r\n                    {\r\n                        targets: 1,\r\n                        data: 'quantity',\r\n                        className: 'text-nowrap'\r\n                    },\r\n                    {\r\n                        targets: 2,\r\n                        data: 'discount',\r\n                        className: 'text-nowrap',\r\n                        render(val) {\r\n                            return drugHelperFunctions.getDiscount(val)\r\n                        }\r\n                    },\r\n                    {\r\n                        targets: 3,\r\n                        data: 'valideDate',\r\n                        className: 'text-nowrap',\r\n                        render(val: Date) {\r\n                            val = new Date(val);\r\n                            return `${val.getMonth()} / ${val.getFullYear()}`\r\n                        }\r\n                    },\r\n                    {\r\n                        targets: 4,\r\n                        data: 'priceType',\r\n                        className: 'text-nowrap',\r\n                        render(val: LzDrugPriceType) {\r\n                            return drugHelperFunctions.getPriceType(val);\r\n                        }\r\n                    },\r\n                    {\r\n                        targets: 5,\r\n                        data: 'desc'\r\n                    }\r\n                ]\r\n            })\r\n            return newTb.get(0).outerHTML;\r\n        },\r\n        get _columnDefs() {\r\n            const _this = this;\r\n            return [\r\n                {\r\n                    targets: 0,\r\n                    data: 'name'\r\n                },\r\n                {\r\n                    orderable: false,\r\n                    targets: 1,\r\n                    data: 'type'\r\n                },\r\n                {\r\n                    orderable: false,\r\n                    targets: 2,\r\n                    data: null,\r\n                    render(val, t, rowData: IVStockDrug) {\r\n                        return vStockHelperFunctions.getTotalPriceInStringFormate(rowData);\r\n                    }\r\n                },\r\n                {\r\n                    orderable: false,\r\n                    targets: 3,\r\n                    data: null,\r\n                    render(val, t, rowData: IVStockDrug) {\r\n                        return `${rowData.products.length} صيدلية`;\r\n                    }\r\n                },\r\n                {\r\n                    orderable: false,\r\n                    targets: 4,\r\n                    data: null,\r\n                    render(row: IVStockDrug, type: string, d, meta) {\r\n                        return _this.makeDetailsColumn(row, meta.row);\r\n                    }\r\n                }\r\n            ] as DataTables.ColumnDefsSettings[]\r\n        },\r\n        handleDetailsColumnActions(dt: DataTables.DataTable) {\r\n            const _this = this;\r\n            $(document).on('click', '.showVstockDetailsBtn', function () {\r\n                const $btn = $(this);\r\n\r\n                var tr = $btn.closest('tr');\r\n                var row = dt.row(tr);\r\n                var rowData = row.data() as IVStockDrug;\r\n                console.log(rowData)\r\n                if (row.child.isShown()) {\r\n                    // This row is already open - close it\r\n                    row.child.hide();\r\n                    tr.removeClass('shown');\r\n                }\r\n                else {\r\n                    // Open this row\r\n                    row.child(_this.getNewInnerTable(rowData)).show();\r\n                    tr.addClass('shown');\r\n                }\r\n\r\n\r\n                $btn.toggleClass('fa-plus-circle').toggleClass('fa-minus-circle');\r\n\r\n            });\r\n        },\r\n        makeDetailsColumn(row: IVStockDrug, index: number) {\r\n\r\n            const showInfoBtn = $(`<i class=\"fa fa-plus-circle  showVstockDetailsBtn\"></i>`);\r\n            return showInfoBtn.get(0).outerHTML;\r\n        },\r\n        tableCreatedRow(row: Node, data: IVStockDrug, dataIndex: number) {\r\n\r\n\r\n\r\n        }\r\n    }\r\n\r\n\r\n    const dtExecuter = new DatatableExecuter(\r\n        $tableDomEl,\r\n        Urls.getVstockApiUrl,\r\n        vstockConfig._dataTable,\r\n        vstockConfig._columnDefs,\r\n        4,\r\n        $tableLoadingEl,\r\n        vstockConfig.tableCreatedRow as any,\r\n        (dt) => {\r\n            vstockConfig.handleDetailsColumnActions(dt);\r\n        }).start();\r\n\r\n\r\n}());"]}